## 配列型

原文[https://go.dev/ref/spec#Array_types](https://go.dev/ref/spec#Array_types)


配列とは、**要素型（element type）** と呼ばれる単一の型の要素からなる番号付きの並びである。要素数は配列の**長さ（length）** と呼ばれ、負の値にはならない。

```
ArrayType   = "[" ArrayLength "]" ElementType .
ArrayLength = Expression .
ElementType = Type .
```

長さは配列型の一部であり、`int` 型の値として表現可能な非負の定数式でなければならない。配列 `a` の長さは組み込み関数 `len` を用いて取得できる。要素には整数インデックス `0` から `len(a)-1` まででアクセスできる。配列型は常に一次元であるが、組み合わせて多次元型を構成することができる。

例：

```go
[32]byte
[2*N] struct { x, y int32 }
[1000]*float64
[3][5]int
[2][2][2]float64  // [2]([2]([2]float64)) と同じ
```

配列型 `T` は、その要素型として直接的または間接的に `T` 自身を持つことはできない。もしその包含型が配列型または構造体型のみで構成されている場合はなおさらである。

#### 無効な配列型の例

```go
type (
	T1 [10]T1                 // T1 の要素型が T1 自身
	T2 [10]struct{ f T2 }     // T2 が構造体の要素として T2 を含む
	T3 [10]T4                 // T3 が T4 の構造体の中で間接的に T3 を含む
	T4 struct{ f T3 }         // T4 が配列 T3 の中で間接的に T4 を含む
)
```

#### 有効な配列型の例

```go
type (
	T5 [10]*T5                // T5 はポインタ経由で T5 を含む（許可される）
	T6 [10]func() T6          // T6 は関数の戻り値型として T6 を含む（許可される）
	T7 [10]struct{ f []T7 }   // T7 はスライス経由で T7 を含む（許可される）
)
```

---

## スライスタイプ

原文[https://go.dev/ref/spec#Slice_types](https://go.dev/ref/spec#Slice_types)



スライスは、基礎となる配列の連続した領域を表す記述子であり、その配列から番号付きの要素列へのアクセスを提供する。スライスタイプは、その要素型の配列に対するすべてのスライスの集合を表す。要素数はスライスの長さと呼ばれ、負の値にはならない。未初期化のスライスの値は `nil` である。

```
SliceType = "[" "]" ElementType .
```

スライス `s` の長さは組み込み関数 `len` によって取得できる。配列とは異なり、これは実行中に変化する可能性がある。要素にはインデックス 0 から `len(s)-1` までの整数でアクセスできる。特定の要素のスライス内でのインデックスは、その基礎配列内でのインデックスより小さい場合がある。

スライスは一度初期化されると、その要素を保持する基礎配列と常に関連付けられる。したがってスライスは、その配列や同じ配列を参照する他のスライスとストレージを共有する。一方で、異なる配列は常に異なるストレージを表す。

スライスの基礎配列は、スライスの末尾を超えて拡張されている場合がある。この範囲を測るものがキャパシティであり、それはスライスの長さと、そのスライスの後に続く配列の長さの合計である。スライスからさらにスライスを取ることで、このキャパシティまでの長さを持つ新しいスライスを生成できる。スライス `a` のキャパシティは組み込み関数 `cap(a)` によって取得できる。

ある要素型 `T` に対して、新しい初期化済みスライスを作成するには、組み込み関数 `make` を使う。この関数はスライスタイプと、長さ、オプションでキャパシティを指定する。`make` で作成されたスライスは常に新しい隠れた配列を割り当て、その配列を参照するスライスを返す。つまり、

```
make([]T, length, capacity)
```

は配列を割り当ててからスライスする操作と同等である。次の2つの式は同じ結果を生む：

```
make([]int, 50, 100)
new([100]int)[0:50]
```

配列と同様に、スライスも常に一次元だが、組み合わせることで高次元のオブジェクトを構築できる。配列の配列では、内側の配列は常に同じ長さを持つように構成される。しかし、スライスのスライス（あるいは配列のスライス）の場合、内側の長さは動的に変わる可能性がある。さらに、内側のスライスはそれぞれ個別に初期化しなければならない。


